Orden,Fase,ID,Bloque,Tarea,Prioridad,Estado,Horas Est.,Descripción Detallada,Nivel Dificultad,Dependencias,Modelo Pricing Referencia,IA Planificación (Ask Mode),IA Ejecución (Agent Mode),IA Corrección,Clasificación Ejecución,Horas Rev.,Capa 1: IA Consultor Legal,Capa 2: Textos Legales (bcn.cl),Capa 3: Causas Reales PJUD,Capa 4: Abogado Validación
1,Fase 1: Ingesta (El Ojo),1.01,01 Cimientos,Init Next.js 16.1 & TS,Alta,Listo,3.0,Inicialización Next.js 16.1 con TypeScript + Tailwind + App Router + Turbopack.,Media,,-,-,-,-,-,-,-,-,-,
2,Fase 1: Ingesta (El Ojo),1.02,01 Cimientos,Shadcn/UI v2 Setup,Alta,Listo,3.0,Shadcn/UI v2 con tema legal profesional. Shell de aplicación para Dashboard y Extensión.,Media,,-,-,-,-,-,-,-,-,-,
3,Fase 1: Ingesta (El Ojo),4.01,04 Scraper,Extension Init (V3),Alta,Listo,6.0,Chrome Extension Manifest V3 con SidePanel API. Interfaz principal del producto activada en pjud.cl.,Media,,-,-,-,-,-,-,-,-,-,
4,Fase 1: Ingesta (El Ojo),1.03,01 Cimientos,Supabase Auth & Config,Alta,Listo,2.0,Supabase SSR Auth con middleware + persistencia de sesión entre Extensión y Dashboard.,Media,,-,-,-,-,-,-,-,-,-,
5,Fase 1: Ingesta (El Ojo),2.01,02 Storage,Bucket de Expedientes,Alta,Listo,3.0,Bucket 'case-files' con RLS policies. Permite subida desde Extensión.,Media,,-,-,-,-,-,-,-,-,-,
6,Fase 1: Ingesta (El Ojo),1.04,01 Cimientos,SQL: Perfiles & RLS,Alta,Listo,7.5,Tabla profiles con plan_type y contadores mensuales por capa. device_fingerprint para anti-multicuentas. RLS completo.,Alta,,-,-,-,-,-,-,-,-,-,
7,Fase 1: Ingesta (El Ojo),4.03,04 Scraper,Direct Upload API,Alta,Listo,6.0,API Route /api/upload: recibe PDF blobs desde Extensión → Storage + DB. Race condition protegida por UNIQUE constraint.,Media,,-,-,-,-,-,-,-,-,-,
8,Fase 1: Ingesta (El Ojo),4.06,04 Scraper,Scraper Remote Config,Alta,Listo,3.0,API Route /api/scraper/config: selectores CSS dinámicos + URL patterns. Soluciona el Ciclo de la Muerte.,Media,,-,-,-,-,-,-,-,-,-,
9,Fase 1: Ingesta (El Ojo),4.09,04 Scraper,PDF Validator & Causa Filter,Alta,Listo,4.0,5 filtros: Tamaño → Origen URL → Magic bytes → SHA-256 dedup → ROL tagging + tipo documento. Lógica se migra al server-side en 4.17.,Alta,,-,-,-,-,-,-,-,-,-,
10,Fase 1: Ingesta (El Ojo),4.12,04 Scraper,SQL: Document Hashes Table,Alta,Listo,2.0,Tabla document_hashes con UNIQUE(user_id + hash). Deduplicación server-side persistente.,Media,,-,-,-,-,-,-,-,-,-,
11,Fase 1: Ingesta (Scraper v2),4.14,04 Scraper v2,PJUD DOM Mapping & Endpoint Discovery,Alta,Listo,4.0,Tarea manual. Navegar PJUD y capturar HTML comentado de cada estado DOM: DOM1 (tabla resultados #dtaTableDetalle) DOM2 (modal #modalDetalleCivil: metadata + folios + cuadernos) DOM3 (modal Anexos #modalAnexoCausaCivil) DOM4 (tabla tras cambio cuaderno #selCuaderno) DOM5 (modal Receptor #modalReceptorCivil) DOM6 (tabs: Litigantes + Notificaciones + Escritos + Exhortos). Capturar endpoints desde DevTools Network: causaCivil.php (POST dtaCausa+token) + docuS/docuN.php (GET dtaDoc) + docCertificado*.php + newebookcivil.php + endpoint Anexos + endpoint Receptor. ESTADO MVP v1: DOM1 y DOM2 mapeados desde Consulta Unificada. Endpoint causaCivil.php y cambio cuaderno capturados. Falta: DOM3 DOM5 y endpoints de Anexos/Receptor. AMPLIACIÓN COMPETENCIA CIVIL COMPLETA: mapear DOM para los 6 libro/tipo civiles (c/v/e/a/f/i) → verificar si DOM2 varía según tipo. HALLAZGO CLAVE: DOM1 contiene caratulado pero DOM2 es el denominador común entre Consulta Unificada y Mis Causas → el caratulado debe extraerse de DOM2 o tratarse como enrichment opcional (ver 4.21). PENDIENTE MVP v1.1 (requiere clave abogado): mapear DOM desde Mis Causas como entry point adicional → comparar DOM2 de ambos entry points → mapear causas libro/tipo f (solo accesibles desde Mis Causas) → verificar dónde aparece caratulado en DOM2 vs DOM1 → documentar diferencias de campos → mapear cookies PHPSESSID en sesión autenticada (ver 4.21).,Media,,,-,-,-,Manual,6.0,,,,
12,Fase 1: Ingesta (Scraper v2),4.15,04 Scraper v2,JWT Viability Testing (Pruebas A-B-C),Alta,Pendiente,3.0,Tarea manual. 6 pruebas — A-C (MVP v1 Consulta Unificada) + D-F (MVP v1.1 Mis Causas). En Git Bash: A) curl PDF endpoint (docuS.php?dtaDoc=JWT) con cookies PHPSESSID+TS01262d1d → confirmar baseline. B) curl PDF sin cookies → determinar si JWT es autosuficiente (API proxy pura) o necesita sesión (fetch desde extensión). C) curl POST a causaCivil.php con JWT+CSRF token → confirmar acceso a HTML detalle causa. Documentar: tiempos expiración JWT (~1h observado) + comportamiento token CSRF (d4ebad366cfb4ef74fee967f43ee94f2) + cookie F5 WAF (TS01262d1d). Resultado de A-C define arquitectura de sync MVP v1. PRUEBAS MVP v1.1 (requieren clave abogado → 4.21): D) curl PDF endpoint con cookies de sesión Mis Causas (PHPSESSID autenticado) → determinar si descargas requieren cookies obligatoriamente. E) curl POST a causaCivil.php desde sesión autenticada Mis Causas → verificar si JWT se comporta igual que desde Consulta Unificada. F) Probar acceso a causa libro/tipo f desde Mis Causas → confirmar que DOM2 es idéntico. Resultado de D-F define si API Sync (4.17) necesita modo dual con cookies.,Baja,4.14,,-,-,-,Manual,2.0,,,,
13,Fase 1: Ingesta (Scraper v2),4.16,04 Scraper v2,JWT Extractor Module (Extension),Alta,Pendiente,8.0,Módulo nuevo en extensión. Reemplaza CausaContext (4.07) + DOMAnalyzer (4.08). Lectura PASIVA del DOM visible (cero clics + cero navegación). Extrae: 1) ROL + metadata de table.table-titulos (tribunal + estado adm + procedimiento + etapa + ubicación + fecha ingreso). 2) JWTs de forms directos: Texto Demanda (docu.php) + Certificado Envío (docCertificadoDemanda.php) + Ebook (newebookcivil.php). 3) JWT de Anexos (onclick=anexoCausaCivil). 4) JWTs de cada option en select#selCuaderno (nombre + JWT). 5) JWT de Receptor (onclick=receptorCivil). 6) CSRF token del DOM. 7) Datos tabulares de 5 tabs (ya presentes en HTML del modal). 8) Lista de folios visibles con JWTs de sus forms (doc principal + certificado escrito). 9) Carátula completa desde fila clickeada en DOM1 (#verDetalle) — NOTA: DOM1 solo disponible en Consulta Unificada; desde Mis Causas el caratulado debe extraerse de DOM2 o ser nullable (ver 4.21). 10) Campo libro_tipo de la causa (c/v/e/a/f/i) desde ROL visible. Envía paquete CausaPackage JSON al service-worker → API. DISEÑO DUAL ENTRY POINT: interfaz CausaPackage con procedimiento (del DOM: 'ordinario'|'ejecutivo'|'sumario'|'monitorio'|'voluntario') + libro_tipo (de la letra del ROL) + caratula nullable + materia (código PJUD) + fuente ('consulta_unificada' | 'mis_causas') + cookies opcionales. NOTA: procedimiento es el eje principal de routing; libro_tipo es metadata. MVP v1: modo Consulta Unificada (caratulado desde DOM1 + libro_tipo detectable + fuente='consulta_unificada'). MVP v1.1: modo Mis Causas (todo desde DOM2 + caratulado best-effort o null + cookies capturadas → ver 4.21). Soportar todos los procedimientos civiles — tipo f solo accesible desde Mis Causas.,Alta,4.14 + 4.15,-,Opus 4.6 Max (cerebro) | Max ON,Opus 4.6 Max (cerebro) | Max ON,Sonnet 4.5 (cerebro) | Debug | Max ON,Semi-manual,4.5,-,-,Validar selectores CSS del módulo contra HTML real capturado en 4.14. Probar extracción de JWTs con 5+ causas reales de diferentes procedimientos (ordinario + ejecutivo + sumario) Y diferentes libro/tipo (al menos c + v + e). Verificar que metadata extraída (ROL + tribunal + procedimiento + etapa + libro_tipo) coincide con lo visible en PJUD. Verificar extracción de caratulado desde DOM1. MVP v1.1: probar extracción desde Mis Causas con causa tipo f (ver 4.21).,-
14,Fase 1: Ingesta (Scraper v2),4.17,04 Scraper v2,API Route /api/scraper/sync,Alta,Pendiente,12.0,API Route /api/scraper/sync (Node.js runtime). Recibe paquete CausaPackage (JWTs + metadata + cookies opcionales según 4.15) desde extensión. Pipeline: 1) Registrar/actualizar causa en DB (cases table con ROL + Tribunal + Carátula nullable + procedimiento (campo propio: 'ordinario'|'ejecutivo'|'sumario'|'monitorio'|'voluntario') + libro_tipo (metadata para display/filtros) + materia (código PJUD original) + fuente_sync — DECISIÓN ARQUITECTURAL: procedimiento es EJE PRINCIPAL de routing (determina plazos/estructura/prompts/acciones). libro_tipo (c/v/e/a/f/i) se conserva como metadata para display y filtros en UI. Razón: tipo c es ambiguo (puede ser ordinario O sumario O monitorio) → procedimiento resuelve la ambigüedad). 2) Descargar PDFs directos (Texto Demanda + Certificado + Ebook) via GET con JWT. 3) Para cada cuaderno: POST a causaCivil.php con JWT del cuaderno → parsear HTML respuesta → extraer JWTs de cada folio → descargar PDFs (doc principal + certificado escrito por folio). 4) POST a endpoint Anexos con JWT → parsear HTML → descargar archivos. 5) Upload cada PDF a Supabase Storage (case-files) + registrar en documents + document_hashes (SHA-256). 6) Actualizar cases.document_count + cases.last_synced_at (para 4.19). Retornar lista de documentos nuevos descargados con metadata (tipo + folio + cuaderno + fecha) para feedback al usuario. 7) Disparar processing queue (7.05) para extracción de texto. Throttle server-side: 500ms-1s entre requests a PJUD. Deduplicación: skip si hash ya existe. Respuesta SSE/polling para progreso tiempo real. Timeout: 5 min máx por sync. Validación: reusar lógica de 4.09 server-side. SOPORTE DUAL ENTRY POINT: si fuente='mis_causas' → incluir cookies PHPSESSID en headers de fetch a PJUD. Si fuente='consulta_unificada' → solo JWT. Registrar procedimiento (campo propio) + libro_tipo (metadata) + materia (código PJUD) + fuente_sync en tabla cases. Caratula puede ser null si viene de Mis Causas sin DOM1. MVP v1: solo fuente 'consulta_unificada' (sin cookies). MVP v1.1: agregar soporte 'mis_causas' con cookies (ver 4.21).,Muy Alta,4.15 + 4.16 + 4.03,-,Opus 4.6 Max (cerebro) | Max ON,Opus 4.6 Max (cerebro) | Max ON,Opus 4.6 (cerebro) | Debug | Max ON,Semi-manual,7.0,-,-,Probar pipeline completo con 5+ causas reales: una ordinaria + una ejecutiva + una sumaria + causas de diferentes libro/tipo (al menos c + v + e). Validar parsing de HTML responses de causaCivil.php contra responses reales capturadas. Verificar deduplicación haciendo re-sync de causa ya sincronizada. Confirmar que todos los PDFs descargados son válidos (magic bytes + contenido legible).,-
15,Fase 1: Ingesta (Scraper v2),4.18,04 Scraper v2,Sync UI v2 (Sidepanel),Alta,Pendiente,5.0,Actualización del Sidepanel (reemplaza 4.11). Flujo: 1) Abogado navega a causa en PJUD. 2) Extensión lee DOM pasivamente (4.16) → muestra preview: ROL + tribunal + carátula + N cuadernos + N folios detectados. 3) Si causa ya sincronizada: compara folios visibles vs cases.document_count → muestra 'Puede haber documentos nuevos desde [last_synced_at]. Sincronizar?' o 'Actualizada'. 4) Abogado presiona Sincronizar. 5) Extensión envía JWTs al API (4.17). 6) Barra de progreso con SSE: Descargando documento 5/47... + Cuaderno 2 de 3... 7) Resultado: N documentos nuevos + N existentes + N errores. CLAVE UX: abogado puede seguir navegando PJUD durante la sync. Si cierra pestaña sync continúa en servidor.,Alta,4.16 + 4.17,-,Sonnet 4.5 (cerebro) | Max ON,Sonnet 4.5 (cerebro) | Max ON,Sonnet 4.5 | Debug | Max OFF,Delegable,3.0,-,-,-,-
16,Fase 1: Ingesta (Scraper v2),4.19,04 Scraper v2,Change Detection & Post-Sync Feedback (Simplificado),Media,Pendiente,2.5,SIMPLIFICADO PARA MVP (reemplaza fingerprint completo). Usa campos existentes en tabla cases: document_count + last_synced_at (ya existen en schema). SIN tabla nueva causa_fingerprints. DETECCIÓN AL REVISITAR: extensión lee DOM visible → cuenta folios visibles por cuaderno → compara contra cases.document_count guardado → si difiere: muestra en sidepanel 'Puede haber documentos nuevos desde [last_synced_at]. Sincronizar?'. Lectura pasiva sin requests adicionales a PJUD. POST-SYNC FEEDBACK (UX CLAVE): al completar sync (4.17) la dedup SHA-256 (document_hashes) ya distingue nuevos vs existentes → el resultado del sync retorna lista de documentos nuevos descargados con metadata (tipo + folio + cuaderno + fecha). 4.18 (Sync UI) muestra: 'Se descargaron N documentos nuevos: [Resolución folio 48 15/02/2026 + Escrito folio 49 18/02/2026 + ...]'. BADGE NUEVO EN VISTAS (5.01): documents.created_at > cases.last_synced_at (de sync anterior) → badge 'Nuevo' en vista de casos del sidepanel. El abogado ve visualmente cuáles documentos son nuevos al abrir su causa. ACTUALIZACIÓN DE CAMPOS: al completar sync exitoso → UPDATE cases SET document_count = (SELECT COUNT(*) FROM documents WHERE case_id = X) + last_synced_at = NOW(). Funciona independientemente del entry point y del procedimiento.,Media,4.17,-,Sonnet 4.5 (cerebro) | Max OFF,Sonnet 4.5 (cerebro) | Max ON,Sonnet 4.5 | Debug | Max OFF,Delegable,1.5,-,-,-,-
17,Fase 1: Ingesta (Scraper v2),4.20,04 Scraper v2,Soporte DOMs adicionales (Receptor + Geo + Tabs),Baja,Pendiente,4.0,Soporte incremental para secciones PJUD no incluidas en sync MVP. Requiere completar mapeo DOM (4.14). Secciones: 1) Modal Receptor (#modalReceptorCivil): información notificaciones receptor + certificaciones + diligencias. Endpoint: receptorCivil(JWT). 2) Modal Georreferencia (#modalGeoReferenciaCivil): ubicación geográfica de diligencias judiciales (mapa). Endpoint: geoReferencia(JWT). 3) Datos tabulares de tabs no descargados: Notificaciones (estado + tipo + fecha + resultado + obs fallida) + Escritos por Resolver (pendientes del tribunal con fecha ingreso) + Exhortos (rol origen + destino + tribunal + estado). Cada sección: mapeo DOM → actualizar JWT Extractor (4.16) → agregar parsing en API Sync (4.17) → almacenar datos en DB. Implementar tras validar MVP con cuadernos + anexos + docs directos.,Media,4.17,-,Sonnet 4.5 (cerebro) | Max OFF,Sonnet 4.5 (cerebro) | Max ON,Sonnet 4.5 | Debug | Max OFF,Semi-manual,3.0,-,-,Requiere HTML real de DOM3 (modal Anexos) y DOM5 (modal Receptor) capturado en 4.14. Probar con causas que tengan actuaciones de receptor y anexos adjuntos. Validar que datos tabulares de tabs (Notificaciones + Escritos por Resolver + Exhortos) se extraen correctamente comparando contra PJUD.,-
18,Fase 2: Digestión (Pipeline),7.01,07 Pipeline,SQL: UNIQUE Constraint Cases,Alta,Listo,5.0,REFACTORIZADO: UNIQUE INDEX en cases(user_id + rol + COALESCE(tribunal)) — SIN caratula en constraint. Caratula pasa a campo informativo/enrichment (puede ser null si causa viene de Mis Causas sin DOM1). Migración 20260213140000 actualizada. NUEVAS COLUMNAS en tabla cases: procedimiento TEXT nullable (valores: 'ordinario'|'ejecutivo'|'sumario'|'monitorio'|'voluntario' — EJE PRINCIPAL DE ROUTING para prompts/acciones/plazos/chunking) + libro_tipo TEXT nullable (valores: c/v/e/a/f/i — METADATA para display/filtros en UI) + materia TEXT nullable (código PJUD original: M09/M10/M11/etc.) + fuente_sync TEXT DEFAULT 'consulta_unificada' (valores: 'consulta_unificada' | 'mis_causas'). Migración adicional para nuevos campos. DECISIÓN ARQUITECTURAL: procedimiento resuelve la ambigüedad de libro_tipo c (que puede ser ordinario O sumario O monitorio). libro_tipo se conserva porque viene en el ROL y es útil para display. Upload route con manejo de constraint violation. RAZÓN DEL CAMBIO: el caratulado solo está disponible en DOM1 (Consulta Unificada); causas sincronizadas desde Mis Causas (MVP v1.1) o causas tipo f no tendrán DOM1. ROL + tribunal ya identifican unívocamente una causa en PJUD.,Alta,4.12,-,-,-,-,-,-,-,-,-,
19,Fase 2: Digestión (Pipeline),7.02,07 Pipeline,SQL: Tabla extracted_texts + document_chunks,Alta,Listo,4.0,Dos tablas nuevas. 1) extracted_texts: texto plano extraído por PDF (document_id FK + full_text + extraction_method ['pdf-parse'|'document-ai'] + page_count + status). 2) document_chunks: fragmentos para RAG (extracted_text_id FK + case_id FK + chunk_index + chunk_text + page_number + section_type + metadata JSONB). RLS por user_id. Índices en case_id y document_id.,Alta,7.01,,GPT-5.3 Codex Extra High (cerebro) | Max ON,GPT-5.3 Codex Extra High (cerebro) | Max ON,GPT-5.3 Codex High (cerebro) | Debug | Max OFF,-,-,-,-,-,-
20,Fase 2: Digestión (Pipeline),7.03,07 Pipeline,PDF Native Text Extraction (pdf-parse),Alta,Listo,4.0,Módulo que extrae texto de PDFs nativos usando pdf-parse v2.4.5 (gratis Apache-2.0). Si texto < 50 chars/página → marca como 'necesita OCR'. Guardar en extracted_texts. Costo: $0.,Media,7.02,,GPT-5.3 Codex High (cerebro) | Max OFF,GPT-5.3 Codex High (cerebro) | Max OFF,GPT-5.3 Codex Fast (cerebro) | Debug | Max OFF,-,-,-,-,-,-
21,Fase 2: Digestión (Pipeline),7.04,07 Pipeline,Google Document AI OCR Integration,Alta,Listo,6.0,SDK @google-cloud/documentai. Para PDFs escaneados. PDF → base64 → processDocument() → texto + metadata por página. Configurar GCP: procesador OCR + service account. PDFs grandes: dividir en lotes de 15 páginas. Costo: $1.50/1000 páginas.,Alta,7.03,,Gemini 3 Pro (cerebro) | Max OFF,GPT-5.3 Codex High (cerebro) | Max OFF,Gemini 3 Pro (cerebro) | Debug | Max OFF,-,-,-,-,-,-
22,Fase 2: Digestión (Pipeline),7.05,07 Pipeline,PDF Processing Orchestrator (Edge Function),Alta,Listo,7.0,Orquestador de extracción de texto de PDFs. Trigger al registrar documento. 1) Descargar PDF. 2) Intentar pdf-parse. 3) Si falla → Document AI. 4) Guardar en extracted_texts. 5) Queue con reintentos (max 3). PDFs >50MB → lotes. Propagar ROL + case_id + tipo como metadata. ALERTA TIMEOUT: Edge Functions tienen timeout de 60s (Supabase) o 150s (Pro). Una causa con muchos PDFs escaneados + OCR puede exceder este límite. ALTERNATIVAS A EVALUAR: 1) Supabase Database Webhooks + pg_net → llama a API Route Node.js (sin timeout corto). 2) Inngest/trigger.dev: job queue con steps y retries nativos. 3) Procesar cada PDF individualmente (un trigger por documento en vez de batch). RECOMENDACIÓN MVP: opción 3 (un documento por invocación de Edge Function) es la más simple y cabe en 60s por PDF. Si un PDF individual excede timeout con OCR → fallback a API Route Node.js con timeout largo.,Muy Alta,7.03 + 7.04,,Opus 4.6 Max (cerebro) | Max ON,Opus 4.6 Max (cerebro) | Max ON,Opus 4.6 (cerebro) | Debug | Max ON,-,-,-,-,-,-
23,Fase 2: Digestión (Pipeline),7.06,07 Pipeline,pgvector Extension + Document Embeddings,Alta,Listo,4.0,Habilitar pgvector en Supabase. Tabla document_embeddings: chunk_id FK + case_id FK + embedding vector(768). Índice HNSW. RLS por user_id. CRÍTICO: índice debe soportar filtrado por case_id para RAG por causa.,Alta,7.02,Embeddings: text-embedding-004 ($0.00625/1M tokens),GPT-5.3 Codex Extra High (cerebro) | Max ON,GPT-5.3 Codex Extra High (cerebro) | Max ON,GPT-5.3 Codex High (cerebro) | Debug | Max OFF,-,-,-,-,-,-
24,Fase 2: Digestión (Pipeline),7.07,07 Pipeline,Legal-Aware Chunking Pipeline (Civil Multi-Procedimiento),Alta,Pendiente,12.0,Chunking especializado para documentos legales civiles chilenos — COMPETENCIA CIVIL COMPLETA: soporta todos los procedimientos civiles (ordinario + ejecutivo + sumario + monitorio + voluntario). Mismo DOM PJUD. Detectar estructura por cases.procedimiento (eje principal de routing). libro_tipo (c/v/e/a/f/i) se conserva como metadata en chunks pero NO se usa para routing. ESTRUCTURAS COMUNES (todos los procedimientos): Resolución judicial: Vistos → Considerandos → Resolutivos (Art. 170 CPC). Sentencia: Parte expositiva → Considerativa → Resolutiva. Escrito procesal: Suma → En lo principal → Otrosí(es) → Petitorio. Actuación receptor: Certificación → Diligencia → Resultado. Auto acordado / Decreto: dispositivo breve. ESTRUCTURAS ORDINARIO: Demanda civil: Presupuestos procesales → Hechos → Derecho (Art. 254 CPC) → Peticiones. Contestación: Excepciones dilatorias → Excepciones perentorias → Hechos → Derecho → Petitorio. Réplica/Dúplica. ESTRUCTURAS EJECUTIVO (Art. 434+ CPC): Demanda ejecutiva: Título ejecutivo invocado → Obligación → Peticiones (mandamiento + embargo). Mandamiento de ejecución y embargo: Orden de requerimiento de pago → Embargo de bienes → Designación depositario. Acta de requerimiento y embargo: Diligencia receptor → Bienes embargados → Tasación. Excepciones del ejecutado (18 causales Art. 464 CPC). Liquidación de crédito: Capital → Intereses → Costas. Acta de remate: Condiciones → Base → Adjudicación. ESTRUCTURAS SUMARIO (Art. 680-692 CPC): Demanda sumaria (arrendamiento Ley 18.101 / comodato precario / interdicto posesorio / Art.680 inc.2). Resolución que cita a comparendo (fija audiencia 5to día Art.683). Acta de audiencia (contestación + conciliación + prueba si procede). Auto de prueba (si no hay conciliación: término probatorio 8d reglas incidentes). Sentencia sumaria (10d desde citación Art.688). MONITORIO (Ley 21.461 — variante rápida para arrendamiento): Demanda monitoria → Resolución que ordena pago 10d → Oposición o lanzamiento directo. Materias PJUD: M09 (Cobro Rentas) + M10 (Precario) + M11 (Comodato Precario) — reconocer estos códigos en cases.materia → mapear a cases.procedimiento='monitorio' para routing. Dividir por límites semánticos respetando secciones. 512-1024 tokens con 15% overlap. Metadata: case_id + document_id + page_number + section_type + cuaderno + folio + procedimiento + libro_tipo (metadata). INVESTIGAR: Summary-Augmented Chunking (SAC) arxiv 2510.06999. ROUTING POR PROCEDIMIENTO: switch(procedimiento) → ordinario|ejecutivo|sumario|monitorio|voluntario → cada uno con sus patrones de secciones específicos. Voluntarios: solicitudes + informes periciales + resoluciones de jurisdicción voluntaria. Tipo f: estructura puede variar → investigar al tener acceso a Mis Causas (MVP v1.1 → 4.21). MVP v1: todos los procedimientos accesibles desde Consulta Unificada. MVP v1.1: agregar causas tipo f (ver 4.21).,Muy Alta,7.05,,Opus 4.6 Max (cerebro) | Max ON,Opus 4.6 Max (cerebro) | Max ON,Opus 4.6 (cerebro) | Debug | Max ON,Semi-manual Light,8.0,Pedir a la IA que defina patrones regex/heurísticos para detectar secciones de cada tipo de documento legal chileno: Vistos/Considerandos/Resolutivos (sentencias Art.170) + Suma/En lo principal/Otrosí/Petitorio (escritos) + Certificación/Diligencia/Resultado (actuaciones receptor). Pedir diferencias estructurales entre demanda ordinaria (Art.254) vs ejecutiva (Art.434) vs sumaria. Cross-reference entre 2+ modelos.,Verificar Art.170 CPC (requisitos sentencia) + Art.254 (requisitos demanda) + Art.434 (títulos ejecutivos) + Art.680-692 (procedimiento sumario) en bcn.cl. Confirmar que las secciones que la IA define coinciden con lo que la ley exige para cada tipo de documento.,Descargar 10 PDFs reales de PJUD: 2 sentencias (ordinaria + ejecutiva) + 2 demandas (ejecutiva + sumaria arrendamiento) + 2 actuaciones receptor (requerimiento de pago + notificación Art.44) + 1 acta de embargo + 1 mandamiento + 1 escrito excepciones Art.464 + 1 auto de prueba. Ejecutar chunker y verificar visualmente que los cortes respetan secciones.,No necesario para MVP. El abogado puede validar calidad del chunking indirectamente al revisar respuestas del RAG en la sesión de prompts (3.04).
25,Fase 2: Digestión (Pipeline),7.08,07 Pipeline,Embedding Generation Pipeline,Alta,Pendiente,5.0,Embeddings con text-embedding-004 de Google. Lotes de 100 chunks. Trigger al completar chunking de una causa. Cola para rate limits. Embeddings de metadata enriquecida (chunk + tipo + causa + página + cuaderno + folio).,Alta,7.06 + 7.07,text-embedding-004: ~$0.003 por causa 500 págs,GPT-5.3 Codex High (cerebro) | Max ON,GPT-5.3 Codex High (cerebro) | Max ON,GPT-5.3 Codex Fast (cerebro) | Debug | Max OFF,Delegable,3.0,-,-,-,-
26,Fase 2: Digestión (Cerebro),3.01,03 Cerebro,Gemini SDK 3-Layer Model Routing,Alta,Pendiente,5.0,SDK @google/generative-ai con routing 3 capas. src/lib/gemini.ts: getModel(mode). CAPA 1: gemini-3-flash ($0.50/$3.00). CAPA 2: gemini-3-flash con long context + caching. CAPA 3: gemini-3-pro con thinking ($2/$12 ≤200K; $4/$18 >200K). Una API key. Config por capa: max_input_tokens + temperature + system_prompt_template.,Alta,,Flash $0.50/$3.00 | Pro $2/$12 (≤200K),Gemini 3 Pro (cerebro) | Max OFF,GPT-5.3 Codex High (cerebro) | Max OFF,Gemini 3 Pro (cerebro) | Agent | Max OFF,Delegable,3.0,-,-,-,-
27,Fase 2: Digestión (Cerebro),3.05,03 Cerebro,Gemini Context Caching Setup,Alta,Pendiente,4.0,Context caching para Capas 2 y 3. Explicit caching: documentos de causa con TTL 30min. Al iniciar análisis → crear cache → reutilizar. 90% descuento. Mínimo: 1024 tokens (Flash) / 4096 tokens (Pro). Implicit caching para queries repetitivas. Monitorear uso.,Alta,3.01,Context caching: 90% descuento,Gemini 3 Pro (cerebro) | Max ON,GPT-5.3 Codex High (cerebro) | Max ON,Gemini 3 Pro (cerebro) | Debug | Max OFF,Delegable,2.5,-,-,-,-
28,Fase 2: Digestión (Cerebro),3.10,03 Cerebro,SQL: Chat History & Conversations Schema,Alta,Pendiente,3.0,Tablas: 1) conversations: id + case_id FK + user_id + title + mode ('fast_chat'|'full_analysis'|'deep_thinking') + created_at + updated_at. 2) chat_messages: id + conversation_id FK + role ('user'|'assistant') + content + sources_cited JSONB + tokens_input int + tokens_output int + model_used text + latency_ms int + created_at. RLS por user_id. Índices: conversation_id + created_at para historial ordenado.,Alta,7.02,,GPT-5.3 Codex Extra High (cerebro) | Max ON,GPT-5.3 Codex Extra High (cerebro) | Max ON,GPT-5.3 Codex High (cerebro) | Debug | Max OFF,Delegable,1.5,-,-,-,-
29,Fase 2: Digestión (Cerebro),3.02,03 Cerebro,RAG Pipeline — Capa 1: Fast Chat (Civil Multi-Procedimiento),Alta,Pendiente,10.0,Pipeline RAG para causas civiles chilenas — COMPETENCIA CIVIL COMPLETA: todos los procedimientos (ordinario + ejecutivo + sumario + monitorio + voluntario). Misma pipeline con system prompt adaptado por procedimiento (eje principal de routing). Routing por cases.procedimiento. libro_tipo como metadata para filtros opcionales. 1) Pregunta + case_id obligatorio. 2) Embedding pregunta. 3) Vector search FILTRADA por case_id + filtro opcional por tipo documento (resolución/escrito/actuación/notificación) y cuaderno. 4) Retrieval híbrido: vector (top-10) + full-text BM25 en Postgres. 5) Reranking: relevancia combinada + priorización temporal (docs recientes primero para consultas de estado procesal). 6) Top-5 chunks + system prompt según cases.procedimiento → gemini-3-flash. 7) Respuesta con citas (foja + fecha + tipo + cuaderno). Multi-query decomposition para preguntas procesales complejas. Ejemplos ordinario: ¿se notificó correctamente? cruza actuación receptor + certificación + plazo Art. 258 CPC. Ejemplos ejecutivo: ¿qué bienes se embargaron? cruza mandamiento + acta embargo + folio receptor. ¿Se opusieron excepciones dentro de plazo? cruza notificación mandamiento + escrito excepciones + plazo 4-8d Art. 459 CPC. Ejemplos sumario: ¿Se notificó la resolución que cita a comparendo? cruza resolución + actuación receptor + plazo 5d Art.683. ¿Hubo conciliación o se recibió la causa a prueba? cruza acta de audiencia + auto de prueba. ¿Se cumplió el lanzamiento? cruza resolución + actuación receptor de lanzamiento. ROUTING SIMPLIFICADO: switch(procedimiento) → prompt especializado. Fallback a prompt civil genérico si procedimiento desconocido. Filtro opcional por libro_tipo en vector search si usuario lo especifica. MVP v1: todos los procedimientos accesibles desde Consulta Unificada. MVP v1.1: causas tipo f vía Mis Causas (ver 4.21).,Muy Alta,7.08 + 3.01 + 3.04 + 3.10,,Opus 4.6 Max (cerebro) | Max ON,Opus 4.6 Max (cerebro) | Max ON,Opus 4.6 (cerebro) | Debug | Max ON,Semi-manual Light,7.0,Pedir a la IA que genere 30+ queries de prueba con respuestas esperadas: 10 ordinario (¿se notificó? ¿se contestó? ¿estado prueba?) + 10 ejecutivo (¿se requirió de pago? ¿bienes embargados? ¿excepciones dentro de plazo?) + 5 sumario (¿se realizó audiencia? ¿hubo conciliación?) + 5 monitorio (¿se notificó resolución de pago?). Para cada query indicar tipo de documento esperado en la cita.,Verificar plazos citados en respuestas del RAG: Art.258 (18d contestación ordinario) + Art.459 (4-8d excepciones ejecutivo) + Art.683 (5d audiencia sumario) + Art.189 (5d apelación). Cada respuesta que mencione un plazo debe ser verificable contra el CPC en bcn.cl.,Indexar 3 causas reales completas (1 ordinaria + 1 ejecutiva + 1 sumaria arrendamiento). Ejecutar las 30+ queries y verificar que respuestas citan documentos correctos comparando contra expediente real. Medir retrieval accuracy: ¿el chunk citado contiene la información correcta?,No necesario para MVP. Las respuestas son informativas y el abogado usuario las valida en uso real. Incluir 3-5 respuestas representativas en la sesión de validación de prompts (3.04) como control adicional.
30,Fase 2: Digestión (Cerebro),3.06,03 Cerebro,Enhanced Analysis Pipeline (Capa 2+3 Fusionadas),Alta,Pendiente,8.0,FUSIÓN ARQUITECTURAL: un solo pipeline de retrieval con modelo configurable. Reemplaza las anteriores Capa 2 (Full Analysis) y Capa 3 (Deep Thinking). El retrieval es idéntico → se implementa UNA vez. Solo cambia el modelo según selección del usuario. Pipeline compartido: RAG top-20 + documentos clave completos según cases.procedimiento: ordinario (demanda + contestación + últimas resoluciones) | ejecutivo (demanda ejecutiva + mandamiento + acta embargo + excepciones si existen + últimas resoluciones) | sumario (demanda + acta audiencia) | voluntario/otros (solicitud + informes + últimas resoluciones) + caching (3.05). MODO ANÁLISIS COMPLETO: modelo = gemini-3-flash long context. System prompt cross-document. Límite Individual: 150/mes. ~$0.015/query. MODO PENSAMIENTO PROFUNDO: modelo = gemini-3-pro thinking. System prompt con CoT ampliado: Marco legal (CPC + CC + leyes especiales según procedimiento) → Artículos aplicables → Hechos del expediente → Análisis procesal → Conclusión + riesgos. Límite Individual: 30/mes. ~$0.13/query. INTERFAZ: getEnhancedAnalysis(case_id + query + mode: 'full_analysis' | 'deep_thinking') → internamente selecciona modelo + system prompt. El abogado sigue viendo 3 modos en UI (Chat Rápido / Análisis Completo / Pensamiento Profundo) sin cambios.,Alta,3.02 + 3.05,Full ~$0.015 | Deep ~$0.13 con cache,Opus 4.6 Max (cerebro) | Max ON,Opus 4.6 Max (cerebro) | Max ON,Opus 4.6 (cerebro) | Debug | Max ON,Semi-manual Light,5.0,Pedir a la IA que defina: 1) Qué documentos clave incluir en long context por procedimiento. 2) Cadena CoT para modo deep_thinking: Marco legal → Artículos → Hechos → Análisis → Conclusión + riesgos. Cross-reference entre modelos.,Verificar artículos CPC citados contra bcn.cl. Especial atención a Art.434-529 (ejecutivo) + Art.680-692 (sumario) + Art.764-808 (casación) + Art.186-189 (apelación).,Probar con 3 causas reales (ordinaria + ejecutiva + sumaria). Comparar calidad Capa 1 vs Full Analysis vs Deep Thinking en 5+ queries complejas cross-document. Probar causa ejecutiva compleja para Deep Thinking.,Incluir 2-3 respuestas de Deep Thinking en la sesión de validación con abogado.
32,Fase 2: Digestión (Cerebro),3.08,03 Cerebro,Chat UI 3 Modos (Sidepanel),Alta,Pendiente,10.0,3 modos: Chat Rápido (rayo) / Análisis Completo (lupa) / Pensamiento Profundo (cerebro). Requiere causa seleccionada. SOLO SIDEPANEL en V1. Acciones rápidas ADAPTATIVAS según cases.procedimiento (eje principal de routing): COMUNES: Resumen del estado actual + Cronología de actuaciones + ¿Cuáles son los próximos plazos? + Documentos clave pendientes + ¿Qué recursos proceden? ORDINARIO: ¿Se notificó correctamente al demandado? + ¿Se contestó la demanda? + Estado de la prueba. EJECUTIVO: ¿Se requirió de pago al ejecutado? + ¿Qué bienes se embargaron? + ¿Se opusieron excepciones? ¿Cuáles? + ¿Estado del remate? + Monto actualizado del crédito + ¿Hay tercerías? SUMARIO: ¿Se notificó al demandado para la audiencia? + ¿Se realizó la audiencia? + ¿Hubo conciliación o se recibió a prueba? + ¿Se dictó sentencia? + ¿Se ordenó lanzamiento/restitución? + ¿Estado del desalojo? MONITORIO: ¿Se notificó la resolución de pago? + ¿Pagó o se opuso? + ¿Se ordenó lanzamiento? Contador uso mensual. Streaming SSE. Historial por causa (conversations + chat_messages). Sección Fuentes obligatoria en cada respuesta. DISPLAY: badge de procedimiento (Ordinario/Ejecutivo/Sumario/Monitorio/Voluntario) como elemento principal + badge secundario de libro/tipo (c/v/e/a/f/i) en selector de causa. Acciones rápidas determinadas por procedimiento. Filtro por procedimiento y opcionalmente por libro/tipo en lista de causas del chat. MVP v1: todos los procedimientos accesibles desde Consulta Unificada. MVP v1.1: causas tipo f (ver 4.21).,Muy Alta,3.06 + 3.10,,Sonnet 4.5 (cerebro) | Max ON,Sonnet 4.5 (cerebro) | Max ON,Sonnet 4.5 | Agent | Max ON,Semi-manual,6.0,Pedir a la IA que refine las acciones rápidas por procedimiento. Validar que las preguntas predefinidas (ej: ¿Se requirió de pago? para ejecutivo vs ¿Se realizó la audiencia? para sumario) cubren los momentos procesales más relevantes según el CPC.,-,Probar cada acción rápida contra causas reales indexadas. Verificar que cada una produce respuesta útil cuando hay datos relevantes y respuesta informativa cuando no los hay (ej: No se encontraron actuaciones de embargo en el expediente).,-
33,Fase 2: Digestión (Cerebro),3.09,03 Cerebro,Citation System (Foja + Cuaderno + Documento),Alta,Pendiente,6.0,Citas automáticas adaptadas a práctica civil chilena en TODA respuesta. Formato: Según [Resolución/Escrito/Actuación] de fecha [DD/MM/YYYY] folio [N] cuaderno [nombre] (pág. N)... Cada chunk incluye metadata [DOC: tipo | FOLIO: N | CUADERNO: X | PÁG: N | SECCIÓN: vistos/considerandos/resolutivos]. Post-procesamiento: parsear citas → links clickeables al PDF con scroll a página. Sidebar de fuentes agrupadas por tipo y fecha. CRÍTICO para adopción por abogados civiles que verifican cada dato.,Alta,3.08,,Opus 4.6 Max (cerebro) | Max ON,GPT-5.3 Codex Extra High (cerebro) | Max ON,GPT-5.3 Codex High (cerebro) | Debug | Max ON,Delegable,4.0,-,-,Verificar formato de citas generadas contra citas en sentencias reales de PJUD. Confirmar que foja + cuaderno + fecha en la cita coinciden con el documento referenciado. Probar con 5+ respuestas del RAG sobre causas reales.,-
34,Fase 2: Digestión (Cerebro),3.11,03 Cerebro,PDF Viewer Component (Sidepanel),Alta,Pendiente,4.0,Visor de PDF embebido usando pdf.js o react-pdf. SOLO SIDEPANEL en V1. 1) Renderizar PDF desde Supabase Storage. 2) Navegación por páginas. 3) Scroll automático a página citada cuando el abogado clickea una fuente del chat. 4) Highlight de texto relevante (opcional). 5) Responsive para Sidepanel (ancho limitado). 6) Lazy loading para PDFs grandes.,Alta,3.09,,Sonnet 4.5 (cerebro) | Max ON,Sonnet 4.5 (cerebro) | Max ON,Sonnet 4.5 | Debug | Max OFF,Delegable,3.0,-,-,-,-
35,Fase 2: Digestión (Cerebro),3.04,03 Cerebro,Prompt Engineering Legal Civil Multi-Procedimiento,Alta,Pendiente,11.0,System prompts especializados en derecho procesal civil chileno — COMPETENCIA CIVIL COMPLETA: multi-procedimiento (ordinario + ejecutivo + sumario + monitorio + voluntario). Routing por cases.procedimiento (eje principal): switch(procedimiento) → aplicar prompt especializado. libro_tipo como metadata informativa (no determina routing). Terminología obligatoria: fojas + carátula + ROL + cuaderno + proveído + despacho + mandamiento + exhorto + receptor + cédula + requerimiento + embargo + remate + título ejecutivo + depositario + tercería. ESTRUCTURA ORDINARIO: demanda → excepciones dilatorias → contestación 18d Art.258 → réplica → dúplica → conciliación obligatoria Art.262 → prueba 20d Art.328 → observaciones 10d Art.430 → sentencia. PLAZOS ORDINARIO: contestación 18d Art.258 + apelación 5d Art.189 + casación 15d Art.770. ESTRUCTURA EJECUTIVO (Art. 434-529 CPC): demanda ejecutiva (requiere título ejecutivo Art.434) → examen título y despacho mandamiento Art.441 → requerimiento de pago por receptor → embargo de bienes (Art.445: orden de embargo) → excepciones 4d Art.459 (notif. personal) u 8d Art.459 inc.2 (notif. Art.44) → 18 causales Art.464 (prescripción/pago/compensación/nulidad obligación/falta requisitos título/etc.) → sentencia Art.470-471 (de pago o remate) → realización de bienes: remate Art.485-502. PLAZOS EJECUTIVO: excepciones 4-8d Art.459 + apelación 5d Art.189 + renovación embargo sin plazo. ESTRUCTURA SUMARIO (Art.680-692 CPC): demanda sumaria → resolución que cita a comparendo 5to día Art.683 → audiencia (contestación oral + conciliación + prueba si procede en misma audiencia o auto de prueba 8d reglas incidentes) → sentencia 10d Art.688. PLAZOS SUMARIO: audiencia 5d Art.683 + término probatorio 8d (reglas incidentes) + apelación 5d Art.189. MATERIAS DE APLICACIÓN OBLIGATORIA (Art.680 inc.2 CPC): arrendamiento (Ley 18.101: término contrato + desahucio + cobro rentas + restitución) + comodato precario + precario + interdictos posesorios (querella amparo/restitución/obra nueva/obra ruinosa Art.549-583 CPC) + acciones accesorias del arrendador + otras por leyes especiales (Código Minería Art.231 + Ley 20.720 concursal). MONITORIO (Ley 21.461 — 2022): procedimiento aún más rápido para arrendamiento. Resolución ordena pago en 10d corridos → si no paga ni se opone → lanzamiento directo en 10d. Materias PJUD: M09 (Monitorio Cobro Rentas) + M10 (Monitorio Precario) + M11 (Monitorio Comodato Precario). Reconocer estos códigos en cases.materia → mapear a cases.procedimiento='monitorio' → aplicar prompts de arrendamiento/desalojo. PERFIL adicional: Abogado arrendamiento/inmobiliario (desahucios + restituciones + cobro rentas + lanzamientos + inventarios de bienes). PERFILES: Juez civil (Art. 160-170 CPC + imparcial + fundamentos de hecho y derecho) + Abogado litigante civil (estrategia procesal + plazos fatales multi-procedimiento) + Abogado ejecutivo/cobranza (eficiencia en gestión masiva + bienes embargables + tercerías Art.518-529) + Revisor de plazos y notificaciones. Filtro causa: responder SOLO con info de la causa (case_id). Calibración iterativa con causas reales de PJUD (incluir ejecutivos BCI/Scotiabank/Ripley típicos de cobranza). ROUTING SIMPLIFICADO POR PROCEDIMIENTO: switch(procedimiento) → prompt ordinario|ejecutivo|sumario|monitorio|voluntario|genérico. Voluntarios: terminología de jurisdicción voluntaria (solicitud + decreto + informe + resolución). Fallback a prompt civil genérico si procedimiento desconocido. MVP v1: prompts para todos los procedimientos accesibles desde Consulta Unificada. MVP v1.1: especializar prompts para causas tipo f al tener acceso a Mis Causas (ver 4.21). REORDENADO: esta tarea se ejecuta ANTES de 3.02 (RAG Pipeline) porque los prompts son prerequisito del RAG. Se puede desarrollar en paralelo con 7.07 (chunking) + 7.08 (embeddings). Validación con abogado (Capa 4) se hace temprano para incorporar feedback antes de construir UI.,Alta,7.07,,Opus 4.6 Max (cerebro) | Max ON,Opus 4.6 Max (cerebro) | Max ON,Opus 4.6 (cerebro) | Agent | Max ON,Semi-manual,8.0,Pedir a la IA que redacte system prompts completos para cada procedimiento (ordinario + ejecutivo + sumario + monitorio) y cada perfil (Juez civil + Abogado litigante + Abogado cobranza + Revisor plazos). Cross-reference entre 2+ modelos (Claude + Gemini). Incluir terminología obligatoria: fojas + carátula + ROL + cuaderno + proveído + mandamiento + requerimiento + embargo + remate + título ejecutivo + depositario + tercería. Cubrir todas las etapas procesales.,Verificar TODOS los artículos CPC citados en prompts contra bcn.cl: Art.254 + Art.258-259 + Art.434 + Art.441 + Art.459 + Art.464 + Art.470-471 + Art.485-502 + Art.680-692 + Art.683 + Art.688 + Art.152 + Art.189 + Art.770. Crear checklist y marcar cada artículo como verificado.,Probar cada prompt con 3+ causas reales del procedimiento correspondiente. Evaluar: ¿usa terminología correcta? ¿cita fojas/cuadernos correctamente? ¿plazos calculados coinciden con los reales? ¿distingue correctamente ordinario vs ejecutivo vs sumario? Iterar prompts con errores encontrados. Documentar hallazgos.,Sesión de 2h con abogado civil litigante. Mostrar 6 respuestas del sistema (2 por procedimiento) + los system prompts. Que valide: terminología + plazos + estructura procesal + que la IA no afirme cosas incorrectas. Incorporar feedback directo del abogado en prompts finales.
36,Fase 3: Producción (Escudo),4.04,04 Seguridad,Middleware: Limits & Rate Guard (2 Planes),Alta,Pendiente,5.0,Rate limiting anti-bot (Upstash/Redis: 20 req/min). Lógica 2 planes: FREE(1 causa/20 fast/0 full/3 deep) | INDIVIDUAL $99(100/1000 Fair Use/150/30). Soft cap + throttle 30s para fast_chat. Hard cap para full_analysis + deep_thinking.,Alta,1.04,Individual $99,GPT-5.3 Codex Extra High (cerebro) | Max ON,GPT-5.3 Codex Extra High (cerebro) | Max ON,GPT-5.3 Codex High (cerebro) | Debug | Max ON,Delegable,4.0,-,-,-,-
37,Fase 3: Producción (Escudo),4.05,04 Seguridad,Fingerprinting Shield,Alta,Pendiente,3.0,FingerprintJS en Auth. Genera visitorId. Si dispositivo ya usó Free → bloquear nueva cuenta gratuita → redirect a Pricing.,Media,1.03,,GPT-5.3 Codex High (cerebro) | Max OFF,Sonnet 4.5 (cerebro) | Max OFF,GPT-5.3 Codex Fast (cerebro) | Agent | Max OFF,Delegable,2.0,-,-,-,-
38,Fase 3: Producción (Escudo),6.03,06 Legal,Privacy Consent Modal (Sidepanel),Alta,Pendiente,3.0,Modal obligatorio ANTES de primera sincronización de causa. Casillas: docs civiles no reservados + autoriza análisis PJud + reconoce IA. Persiste en DB. Aparece antes de JWT Extractor (4.16).,Media,4.16,,Sonnet 4.5 | Max OFF,Sonnet 4.5 (cerebro) | Max ON,Sonnet 4.5 | Agent | Max OFF,Delegable,2.0,Pedir a la IA que redacte los textos del modal: qué datos se procesan (documentos judiciales civiles no reservados) + qué hace el sistema (análisis con IA) + que el usuario reconoce naturaleza asistencial de la IA.,Verificar Ley 19.628 (protección de datos personales Chile) para requisitos mínimos de consentimiento informado en procesamiento de datos judiciales.,-,Incluir texto del modal en la revisión de Legal & Terms (5.03) con abogado.
39,Fase 3: Producción (Escudo),2.02,02 Privacidad,Privacy: Vertex AI Logs Disabled,Alta,Pendiente,1.5,Deshabilitar data logging y model training en Vertex AI / Google AI Studio. Protege privilegio abogado-cliente. Aplica para Gemini (RAG/Chat).,Alta,,,Gemini 3 Pro (cerebro) | Max OFF,Gemini 3 Pro (cerebro) | Max OFF,Gemini 3 Pro (cerebro) | Agent | Max OFF,Manual,1.5,-,-,-,-
40,Fase 3: Producción (Escudo),2.05,02 Storage,The Reaper (Cron Job),Alta,Pendiente,3.0,pg_cron nocturno. DELETE storage + extracted_texts + document_chunks + document_embeddings + conversations + chat_messages + datos de FREE con last_active > 7 días. PRESERVAR profile + metadata causa (ghost card). Limpiar caches expirados.,Media,7.02 + 3.10 + 4.19,,GPT-5.3 Codex High (cerebro) | Max ON,GPT-5.3 Codex High (cerebro) | Max ON,GPT-5.3 Codex High (cerebro) | Debug | Max OFF,Delegable,2.0,-,-,-,-
41,Fase 4: Frontend,5.01,05 Frontend,Vistas de Casos (Sidepanel completo + Dashboard mínimo),Alta,Pendiente,9.0,SIDEPANEL (completo): Real-time (Supabase subscriptions). useOptimistic React 19. Agrupar por causa (ROL + Tribunal). Badge PRINCIPAL de procedimiento (Ordinario/Ejecutivo/Sumario/Monitorio/Voluntario) desde cases.procedimiento — color-coded para identificación rápida (eje de routing). Badge SECUNDARIO de libro/tipo (c/v/e/a/f/i) desde cases.libro_tipo como metadata visual complementaria. Organizar por cuaderno y dentro de cuaderno por tipo (resoluciones/escritos/actuaciones/notificaciones). Mostrar folio + fecha + descripción trámite por documento. Indicadores: estado pipeline (pendiente OCR/procesando/listo IA) + estado sync (sincronizado/desactualizado vía 4.19) + badge 'Nuevo' en documentos donde created_at > last_synced_at anterior. Capa disponible según plan. Filtro principal por procedimiento + filtro secundario por libro/tipo. COMPETENCIA CIVIL COMPLETA: soportar todos los procedimientos civiles. Caratulado puede ser null → mostrar ROL + Tribunal como identificador mínimo. DASHBOARD (mínimo V1): lista simple de causas sincronizadas (ROL + Tribunal + procedimiento + estado sync + fecha última sync) + link a gestión de suscripción (6.01). Sin chat ni visor PDF en Dashboard V1.,Muy Alta,7.05 + 4.19,,Sonnet 4.5 (cerebro) | Max ON,Sonnet 4.5 (cerebro) | Max ON,Sonnet 4.5 | Debug | Max ON,Semi-manual,6.0,Pedir a la IA que defina jerarquía visual óptima para expediente civil chileno: causa (ROL + Tribunal + Carátula) → cuaderno → tipo documento (resoluciones/escritos/actuaciones/notificaciones) → folio individual. Pedir recomendaciones UX para badges de procedimiento (Ordinario/Ejecutivo/Sumario) e indicadores de estado.,-,Cargar 3 causas reales completas con todos sus documentos. Verificar que la organización visual (cuadernos + folios + tipos) coincida con cómo PJUD organiza el expediente. El abogado usuario debe reconocer la estructura intuitivamente.,-
42,Fase 4: Negocio,6.04,06 Negocio,SQL: Plans Schema Update (2 Planes + OCR),Alta,Pendiente,2.0,Actualizar profiles: monthly_full_analysis_count + monthly_full_analysis_limit + max_causes. plan_type CHECK: 'free'|'individual'. Tabla ocr_usage: pages_processed + monthly_pages. check_user_limits() para 3 capas × 2 planes. Soft cap fast_chat + hard cap full_analysis/deep_thinking. maybe_reset_monthly_counters().,Alta,1.04,Free(1/20/0/3) | Ind(100/1000/150/30),GPT-5.3 Codex Extra High (cerebro) | Max ON,GPT-5.3 Codex Extra High (cerebro) | Max ON,GPT-5.3 Codex High (cerebro) | Debug | Max OFF,Delegable,2.0,-,-,-,-
43,Fase 4: Negocio,6.01,06 Negocio,Stripe & Webhooks (1 Plan Pago),Alta,Pendiente,4.0,Stripe Wrappers Supabase. 1 suscripción: Individual $99/mes. Webhooks: activar → plan_type='individual' + resetear contadores + asignar límites. Cancelar → free + timer Reaper. Dashboard para gestión de suscripción. Estado consultable desde Extensión.,Alta,6.04,Margen Individual 76%,GPT-5.3 Codex Extra High (cerebro) | Max ON,GPT-5.3 Codex Extra High (cerebro) | Max ON,GPT-5.3 Codex High (cerebro) | Debug | Max ON,Semi-manual,3.0,-,-,-,-
44,Fase 4: Negocio,5.02,05 Frontend,Landing Page (2 Planes + Pricing),Media,Pendiente,6.0,Landing high-conversion. Hero + 'Cómo funciona' (Sincronizar→Procesar→Preguntar) + Demo + Pricing (Free/Individual $99). 'Menos de lo que cobra un procurador por una gestión'. Tabla comparativa features Free vs Individual. CTA: descargar extensión. Mostrar 3 capas IA como diferenciador. Sección competencia civil completa: 'Cubre TODA la competencia civil — desde ejecutivos de cobranza hasta procedimientos voluntarios y sumarios de arrendamiento. Los 6 libro/tipo: todo lo que pasa por PJUD Civil'.,Media,,,Sonnet 4.5 | Max OFF,Sonnet 4.5 (cerebro) | Max OFF,Sonnet 4.5 | Agent | Max OFF,Semi-manual,5.0,Pedir a la IA que genere copywriting de conversión: hero + Cómo funciona + propuesta de valor por procedimiento + tabla comparativa planes. Adaptar lenguaje al mercado legal chileno (jerga profesional + dolor del abogado litigante).,-,-,-
45,Fase 4: Negocio,5.03,05 Frontend,Legal & Terms Pages,Baja,Pendiente,2.0,Términos de Servicio + Política de Privacidad. Requisito Chrome Web Store. Cláusula procesamiento IA (Gemini + Claude) + limitación responsabilidad + retención (7 días free / permanente pagos).,Baja,,,Gemini 3 Flash (cerebro) | Max OFF,Sonnet 4.5 | Max OFF,Gemini 3 Flash (cerebro) | Agent | Max OFF,Semi-manual,2.0,Pedir a la IA que redacte Términos de Servicio y Política de Privacidad para SaaS legal chileno. Incluir: procesamiento IA (Gemini + Claude) + limitación responsabilidad por análisis legal generado por IA + retención datos (7d free / permanente pagos) + Ley 19.628 protección datos personales.,Verificar requisitos Ley 19.628 (protección datos) + requisitos Chrome Web Store para extensiones que procesan datos sensibles. Verificar obligaciones como responsable de base de datos.,-,Incluir TOS y Privacy Policy en sesión de validación con abogado. Si presupuesto lo permite consultar abogado especialista en protección de datos para revisión adicional. Verificar cumplimiento normativo chileno.
46,Fase 5: Optimización,1.06,01 Cimientos,Next.js 'use cache' Setup,Alta,Pendiente,3.0,Directiva 'use cache' en server components para Sidepanel (API). Cachear: listas causas + datos estáticos + config scraper + fingerprints causa.,Media,5.01,,GPT-5.3 Codex High (cerebro) | Max ON,GPT-5.3 Codex High (cerebro) | Max ON,GPT-5.3 Codex Fast (cerebro) | Agent | Max OFF,Delegable,2.5,-,-,-,-
47,Fase 5: Optimización,8.01,08 QA,Test Suite & QA Pipeline,Alta,Pendiente,12.0,Tests integración: pipeline OCR → chunking → embeddings (texto correcto + chunks respetan estructura legal civil multi-procedimiento). Tests precisión RAG multi-procedimiento (COMPETENCIA CIVIL COMPLETA — routing por procedimiento): 10+ queries ordinario + 10+ queries ejecutivo + 5+ queries sumario con respuestas esperadas → evaluar retrieval accuracy + citation correctness + terminología CPC por procedimiento. Tests ejecutivo específicos: ¿se embargaron bienes? → debe citar acta embargo. ¿Se opusieron excepciones? → debe citar escrito excepciones + plazo Art.459. Tests E2E: flujo sync Extension (JWT Extractor → API Sync → procesamiento → chat con citas) con causa ejecutiva real (ej: C-1-2025 BANCO/MENA de DOM2.html). Tests regresión: cambios en prompts no degradan calidad en ningún procedimiento. Test routing: verificar que cases.procedimiento rutea correctamente a prompts y quick actions del procedimiento correspondiente. Verificar que libro_tipo se muestra correctamente como metadata/badge. EXTENSIÓN COMPETENCIA CIVIL COMPLETA: tests de sync/routing/RAG para todos los procedimientos. Tests de caratulado nullable (causa sin DOM1). Tests de UNIQUE constraint sin caratula (7.01 refactorizado). MVP v1: tests con todos los procedimientos accesibles desde Consulta Unificada.,Alta,3.09 + 4.17,,Opus 4.6 Max (cerebro) | Max ON,GPT-5.3 Codex Extra High (cerebro) | Max ON,GPT-5.3 Codex High (cerebro) | Debug | Max ON,Semi-manual Light,8.0,Pedir a la IA que genere set completo de test cases: 10+ queries ordinario + 10+ queries ejecutivo + 5+ queries sumario + 5+ monitorio. Cada test con: query + expected_answer + expected_citations (tipo doc + folio + cuaderno) + CPC_articles_referenced. Pedir también test cases para editor: estructura esperada de cada tipo de escrito.,Verificar artículos CPC referenciados en expected_answers de los test cases. Cada test que cite un plazo o artículo debe ser verificado contra bcn.cl antes de incluirlo como caso de prueba válido.,Crear fixtures de test con 3 causas reales indexadas (ordinaria + ejecutiva + sumaria). Ejecutar queries y comparar output real vs expected. Los documentos reales del expediente son la fuente de verdad para validar que las citas (foja + cuaderno + fecha) son correctas.,Incluir 5 test cases fallidos o borderline en la sesión de validación con abogado para determinar si el expected_answer es correcto o si debe ajustarse el criterio de evaluación.
48,Fase 2: Digestión (Cerebro),3.13,03 Cerebro,Acción Rápida: Análisis de Plazos Fatales vía RAG (Light),Alta,Pendiente,4.0,Versión MVP del Motor de Plazos (10.01) implementada como acción rápida en Chat UI (3.08) + prompt especializado en 3.04. NO calcula plazos automáticamente — usa RAG para analizar la causa y responder. Acción rápida predefinida por procedimiento (eje principal): ¿Cuáles son los plazos vigentes en esta causa? La IA: 1) Busca notificaciones recientes en el expediente (actuaciones receptor + certificaciones + estado diario). 2) Identifica resoluciones notificadas y tipo de notificación. 3) Aplica reglas CPC del procedimiento correspondiente (ordinario: Art.258-259 / ejecutivo: Art.459 / sumario: Art.683). 4) Calcula días hábiles restantes (Art.66 CPC) considerando feriados. 5) Responde con tabla: Plazo | Vence | Días restantes | Artículo CPC | Estado (vigente/vencido). System prompt dedicado en 3.04 con reglas de plazos por procedimiento. Limitación vs. 10.01: requiere que el abogado pregunte activamente (no hay alertas automáticas ni calendario). Pero entrega el 80% del valor con 20% del esfuerzo. Si el abogado pregunta cada mañana ¿plazos? ya tiene control básico. ROUTING POR PROCEDIMIENTO: reglas de plazos para cada procedimiento (ordinario + ejecutivo + sumario + monitorio + voluntario). switch(procedimiento) → reglas CPC correspondientes. MVP v1: plazos para todos los procedimientos accesibles desde Consulta Unificada. MVP v1.1: plazos para causas tipo f (ver 4.21).,Alta,3.02 + 3.08,Gemini Flash $0.50/$3.00 por M tokens. ~$0.005/query (1 fast_chat). Sin costo adicional: consume cuota fast_chat del plan,Opus 4.6 Max (cerebro) | Max ON,Opus 4.6 Max (cerebro) | Max ON,Opus 4.6 (cerebro) | Debug | Max ON,Semi-manual Light,3.0,Pedir a la IA que diseñe prompt especializado con TODAS las reglas de plazos: Art.258 (18d contestación) + Art.459 (4-8d excepciones) + Art.683 (5d audiencia) + Art.189 (5d apelación) + Art.770 (15d casación) + Art.66 (cómputo días hábiles) + Art.152 (6m abandono). Pedir tabla feriados Chile 2025-2027. Incluir reglas de fecha efectiva por tipo notificación (personal=inmediata + Art.44=3er día hábil + estado diario=día siguiente).,Verificar cada regla de plazo contra CPC en bcn.cl: Art.258 + 259 + 459 + 683 + 189 + 770 + 66 + 152. Verificar tabla de feriados contra calendario oficial de Chile (feriados irrenunciables Ley 19.973).,Tomar 3 causas reales donde se conozcan plazos ya vencidos (ej: causa donde se contestó demanda dentro/fuera de plazo). Ejecutar acción rápida y comparar plazos calculados vs los que realmente corrieron. Si una causa tuvo contestación extemporánea el sistema debe detectarlo.,-
